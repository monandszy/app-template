<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="/vendored/htmx.min.js"></script>
  <title>Thymeleaf and HTMX</title>
  <script>
    function updateList() {
      htmx.ajax('GET', '/catnip/list', { target: '#catnip-list' });
    }
  </script>
</head>
<body>

<h1>Catnip List</h1>
<form
  hx-post="catnip"
  hx-swap="none"
  hx-trigger="submit"
  th:object="${catnipCreateDTO}"
  hx-on--after-request="updateList()"
>
  <button type="submit" th:text="Add"
  ></button>
</form>

<input class="search-form" type="search"
       name="query" placeholder="Search..."
       hx-get="/catnip/list"
       hx-trigger="input changed delay:500ms, search, submit"
       hx-target="#catnip-list"
       hx-vals='{"page": 0}'
>

<div>
  <p>Sort:</p>
  <button
    hx-get="/catnip/list"
    hx-target="#catnip-list"
    hx-vals='{"sort":"id","page":0}'
  >Default
  </button>
  <th:block th:each="sortOption : ${sortOptions}">
    <button
      hx-get="/catnip/list"
      hx-target="#catnip-list"
      hx:vals="${ {sort: sortOption, page:0} }"
    > [[${sortOption}]]
    </button>
  </th:block>
</div>

<div th:replace="~{fragments/catnip-list :: catnipList}"></div>


<footer>

</footer>
</body>
</html>